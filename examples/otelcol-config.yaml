receivers:
  otlp:
      protocols:
            grpc:
                    endpoint: "0.0.0.0:4317"
                          http:
                                  endpoint: "0.0.0.0:4318"

                                  processors:
                                    genaisafe:
                                        redact:
                                              mode: "hash_and_preview"
                                                    preview_chars: 48
                                                          salt: "change-me-in-prod"
                                                                keys:
                                                                        - "gen_ai.prompt"
                                                                                - "gen_ai.completion"
                                                                                        - "llm.prompt"
                                                                                                - "llm.completion"
                                                                                                        - "genai.prompt"
                                                                                                                - "genai.completion"
                                                                                                                      denylist_regex:
                                                                                                                              - "(?i)api[_-]?key"
                                                                                                                                      - "(?i)authorization"
                                                                                                                                              - "(?i)bearer\\s+[a-z0-9\\-\\._~\\+\\/]+=*"
                                                                                                                                                      - "(?i)sk-[a-z0-9]{20,}"
                                                                                                                                                          metrics:
                                                                                                                                                                enable: true
                                                                                                                                                                      emit_interval: "10s"
                                                                                                                                                                            token_attr_candidates:
                                                                                                                                                                                    - "gen_ai.usage.prompt_tokens"
                                                                                                                                                                                            - "gen_ai.usage.completion_tokens"
                                                                                                                                                                                                    - "llm.usage.prompt_tokens"
                                                                                                                                                                                                            - "llm.usage.completion_tokens"
                                                                                                                                                                                                                  cost_attr_candidates:
                                                                                                                                                                                                                          - "gen_ai.usage.cost_usd"
                                                                                                                                                                                                                                  - "llm.usage.cost_usd"
                                                                                                                                                                                                                                      loop_detection:
                                                                                                                                                                                                                                            enable: true
                                                                                                                                                                                                                                                  tool_span_name_regex: "(?i)tool|function|call"
                                                                                                                                                                                                                                                        repeat_threshold: 6
                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                        exporters:
                                                                                                                                                                                                                                                          otlp:
                                                                                                                                                                                                                                                              endpoint: "jaeger:4317"
                                                                                                                                                                                                                                                                  tls:
                                                                                                                                                                                                                                                                        insecure: true
                                                                                                                                                                                                                                                                          prometheus:
                                                                                                                                                                                                                                                                              endpoint: "0.0.0.0:8889"
                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                              service:
                                                                                                                                                                                                                                                                                pipelines:
                                                                                                                                                                                                                                                                                    traces:
                                                                                                                                                                                                                                                                                          receivers: [otlp]
                                                                                                                                                                                                                                                                                                processors: [genaisafe]
                                                                                                                                                                                                                                                                                                      exporters: [otlp]
                                                                                                                                                                                                                                                                                                          metrics:
                                                                                                                                                                                                                                                                                                                receivers: [otlp]
                                                                                                                                                                                                                                                                                                                      processors: []
                                                                                                                                                                                                                                                                                                                            exporters: [prometheus]
